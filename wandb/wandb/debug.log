2025-10-15 12:49:04,469 INFO    MainThread:1424801 [wandb_setup.py:_flush():79] Current SDK version is 0.18.7
2025-10-15 12:49:04,469 INFO    MainThread:1424801 [wandb_setup.py:_flush():79] Configure stats pid to 1424801
2025-10-15 12:49:04,469 INFO    MainThread:1424801 [wandb_setup.py:_flush():79] Loading settings from /mnt/home/at3836/.config/wandb/settings
2025-10-15 12:49:04,470 INFO    MainThread:1424801 [wandb_setup.py:_flush():79] Loading settings from /mnt/home/at3836/Contrastive_Learning/files/results/exprmnt_2025_10_15__12_47_49/files/wandb/settings
2025-10-15 12:49:04,470 INFO    MainThread:1424801 [wandb_setup.py:_flush():79] Loading settings from environment variables: {}
2025-10-15 12:49:04,470 WARNING MainThread:1424801 [wandb_setup.py:_flush():79] Could not find program at -m scripts.cl_training
2025-10-15 12:49:04,470 INFO    MainThread:1424801 [wandb_setup.py:_flush():79] Inferring run settings from compute environment: {'program_relpath': None, 'program': '-m scripts.cl_training'}
2025-10-15 12:49:04,470 INFO    MainThread:1424801 [wandb_setup.py:_flush():79] Applying login settings: {'api_key': '***REDACTED***'}
2025-10-15 12:49:04,470 INFO    MainThread:1424801 [wandb_setup.py:_flush():79] Applying login settings: {'api_key': '***REDACTED***'}
2025-10-15 12:49:04,470 INFO    MainThread:1424801 [wandb_setup.py:_flush():79] Applying login settings: {}
2025-10-15 12:49:04,470 INFO    MainThread:1424801 [wandb_init.py:_log_setup():533] Logging user logs to /mnt/home/at3836/Contrastive_Learning/files/results/exprmnt_2025_10_15__12_47_49/files/wandb/wandb/run-20251015_124904-sipnifg2/logs/debug.log
2025-10-15 12:49:04,470 INFO    MainThread:1424801 [wandb_init.py:_log_setup():534] Logging internal logs to /mnt/home/at3836/Contrastive_Learning/files/results/exprmnt_2025_10_15__12_47_49/files/wandb/wandb/run-20251015_124904-sipnifg2/logs/debug-internal.log
2025-10-15 12:49:04,470 INFO    MainThread:1424801 [wandb_init.py:init():619] calling init triggers
2025-10-15 12:49:04,470 INFO    MainThread:1424801 [wandb_init.py:init():626] wandb.init called with sweep_config: {}
config: {'wandb': {'api_key': '6c6c3f0e63c48c1d9b78f03948c5eb5a4f828a66', 'dir': '/mnt/home/at3836/Contrastive_Learning/files/results/exprmnt_2025_10_15__12_47_49/files/wandb'}, 'logger': {'_target_': 'lightning.pytorch.loggers.WandbLogger', 'name': 'EMPRAICL_alldata_resnet3p_weightedsupcon10_2025_10_15__12_47_49', 'id': 'introns_cl-EMPRAICL_alldata_resnet3p_weightedsupcon10_2025_10_15__12_47_49', 'project': 'INTRONS_CL', 'group': 'introns_cl', 'save_dir': '/mnt/home/at3836/Contrastive_Learning/files/results/exprmnt_2025_10_15__12_47_49/files/wandb', 'log_model': True, 'notes': 'all data 3p supcon resnet ten aug weighted', 'settings': {'init_timeout': 600}}, 'embedder': {'bp_per_token': 1, 'embedding_dim': 768, 'seq_len': 201, 'vocab_size': 11, 'rcps': False, 'maxpooling': True, 'size': 50, '_name_': 'ResNet1D', 'name_or_path': 'ResNet1D'}, 'dataset': {'seq_len': 199, 'train_data_file': '/mnt/home/at3836/Contrastive_Learning/data/final_data/intronExonSeq_multizAlignment_noDash/trainTestVal_data/train_3primeIntron_filtered_min30views.pkl', 'val_data_file': '/mnt/home/at3836/Contrastive_Learning/data/final_data/intronExonSeq_multizAlignment_noDash/trainTestVal_data/val_3primeIntron_filtered.pkl', 'test_data_file': '/mnt/home/at3836/Contrastive_Learning/data/final_data/intronExonSeq_multizAlignment_noDash/trainTestVal_data/test_3primeIntron_filtered.pkl', 'batch_size_per_device': 2048, 'num_workers': 8, 'train_ratio': 0.8, 'val_ratio': 0.1, 'test_ratio': None, 'cache_dir': '../data', 'n_augmentations': 10, 'fixed_species': False}, 'task': {'_name_': 'introns_cl', 'metrics': ['accuracy'], 'val_check_interval': 1.0, 'global_batch_size': 2048}, 'trainer': {'_target_': 'lightning.pytorch.Trainer', 'max_epochs': 100, 'callbacks': None, 'devices': 1, 'log_every_n_steps': 1, 'limit_train_batches': 1.0, 'limit_val_batches': 1.0, 'val_check_interval': 0.5, 'gradient_clip_val': 1.0, 'precision': '16-mixed', 'num_sanity_val_steps': 0, 'num_nodes': 1, 'accumulate_grad_batches': 1}, 'callbacks': {'model_checkpoint': {'_target_': 'lightning.pytorch.callbacks.ModelCheckpoint', 'dirpath': '/mnt/home/at3836/Contrastive_Learning/files/results/exprmnt_2025_10_15__12_47_49/weights/checkpoints', 'filename': 'introns_cl/ResNet1D/199/best-checkpoint', 'save_top_k': 1, 'save_last': True, 'verbose': True, 'monitor': 'val_loss', 'mode': 'min'}, 'learning_rate_monitor': {'_target_': 'lightning.pytorch.callbacks.LearningRateMonitor', 'logging_interval': 'step'}}, 'tokenizer': {'_target_': 'src.tokenizers.custom.CustomTokenizer', 'seq_len': 400, 'model_max_length': 400, 'padding': 'longest'}, 'loss': {'_target_': 'src.loss.weighted_supcon.weightedSupConLoss', 'temperature': 0.5, 'correlation_dir': '/mnt/home/at3836/Contrastive_Learning/data/final_data/intronExonSeq_multizAlignment_noDash/trainTestVal_data'}, 'model': {'name_or_path': 'simclr', 'hidden_dim': 512, 'projection_dim': 128}, 'optimizer': {'_target_': 'torch.optim.SGD', 'lr': 0.01, 'momentum': 0.9, 'weight_decay': 0.0}}
2025-10-15 12:49:04,471 INFO    MainThread:1424801 [wandb_init.py:init():669] starting backend
2025-10-15 12:49:04,471 INFO    MainThread:1424801 [wandb_init.py:init():673] sending inform_init request
2025-10-15 12:49:04,473 INFO    MainThread:1424801 [backend.py:_multiprocessing_setup():104] multiprocessing start_methods=fork,spawn,forkserver, using: spawn
2025-10-15 12:49:04,474 INFO    MainThread:1424801 [wandb_init.py:init():686] backend started and connected
2025-10-15 12:49:04,480 INFO    MainThread:1424801 [wandb_init.py:init():781] updated telemetry
2025-10-15 12:49:04,481 INFO    MainThread:1424801 [wandb_init.py:init():814] communicating run to backend with 600.0 second timeout
2025-10-15 12:49:05,120 INFO    MainThread:1424801 [wandb_init.py:init():867] starting run threads in backend
2025-10-15 12:49:06,340 INFO    MainThread:1424801 [wandb_run.py:_console_start():2456] atexit reg
2025-10-15 12:49:06,340 INFO    MainThread:1424801 [wandb_run.py:_redirect():2305] redirect: wrap_raw
2025-10-15 12:49:06,340 INFO    MainThread:1424801 [wandb_run.py:_redirect():2370] Wrapping output streams.
2025-10-15 12:49:06,343 INFO    MainThread:1424801 [wandb_run.py:_redirect():2395] Redirects installed.
2025-10-15 12:49:06,354 INFO    MainThread:1424801 [wandb_init.py:init():911] run started, returning control to user process
2025-10-15 12:49:06,390 INFO    MainThread:1424801 [wandb_run.py:_config_callback():1387] config_cb None None {'config': "{'wandb': {'api_key': '6c6c3f0e63c48c1d9b78f03948c5eb5a4f828a66', 'dir': '/mnt/home/at3836/Contrastive_Learning/files/results/exprmnt_2025_10_15__12_47_49/files/wandb'}, 'logger': {'_target_': 'lightning.pytorch.loggers.WandbLogger', 'name': 'EMPRAICL_alldata_resnet3p_weightedsupcon10_2025_10_15__12_47_49', 'id': '${task._name_}-${.name}', 'project': 'INTRONS_CL', 'group': '${task._name_}', 'save_dir': '${wandb.dir}', 'log_model': True, 'notes': 'all data 3p supcon resnet ten aug weighted', 'settings': {'init_timeout': 600}}, 'embedder': {'bp_per_token': 1, 'embedding_dim': 768, 'seq_len': 201, 'vocab_size': 11, 'rcps': False, 'maxpooling': True, 'size': 50, '_name_': 'ResNet1D', 'name_or_path': 'ResNet1D'}, 'dataset': {'seq_len': 199, 'train_data_file': '/mnt/home/at3836/Contrastive_Learning/data/final_data/intronExonSeq_multizAlignment_noDash/trainTestVal_data/train_3primeIntron_filtered_min30views.pkl', 'val_data_file': '/mnt/home/at3836/Contrastive_Learning/data/final_data/intronExonSeq_multizAlignment_noDash/trainTestVal_data/val_3primeIntron_filtered.pkl', 'test_data_file': '/mnt/home/at3836/Contrastive_Learning/data/final_data/intronExonSeq_multizAlignment_noDash/trainTestVal_data/test_3primeIntron_filtered.pkl', 'batch_size_per_device': '${div_up:${task.global_batch_size}, ${eval:${trainer.devices}  * ${trainer.num_nodes}}}', 'num_workers': '${optimal_workers:}', 'train_ratio': 0.8, 'val_ratio': 0.1, 'test_ratio': None, 'cache_dir': '../data', 'n_augmentations': 10, 'fixed_species': False}, 'task': {'_name_': 'introns_cl', 'metrics': ['accuracy'], 'val_check_interval': 1.0, 'global_batch_size': 2048}, 'trainer': {'_target_': 'lightning.pytorch.Trainer', 'max_epochs': 100, 'callbacks': None, 'devices': 1, 'log_every_n_steps': 1, 'limit_train_batches': 1.0, 'limit_val_batches': 1.0, 'val_check_interval': 0.5, 'gradient_clip_val': 1.0, 'precision': '16-mixed', 'num_sanity_val_steps': 0, 'num_nodes': 1, 'accumulate_grad_batches': '${div_up:${task.global_batch_size}, ${eval:${trainer.devices} * ${dataset.batch_size_per_device} * ${trainer.num_nodes}}}'}, 'callbacks': {'model_checkpoint': {'_target_': 'lightning.pytorch.callbacks.ModelCheckpoint', 'dirpath': '/mnt/home/at3836/Contrastive_Learning/files/results/exprmnt_2025_10_15__12_47_49/weights/checkpoints', 'filename': '${task._name_}/${embedder._name_}/${dataset.seq_len}/best-checkpoint', 'save_top_k': 1, 'save_last': True, 'verbose': True, 'monitor': 'val_loss', 'mode': 'min'}, 'learning_rate_monitor': {'_target_': 'lightning.pytorch.callbacks.LearningRateMonitor', 'logging_interval': 'step'}}, 'tokenizer': {'_target_': 'src.tokenizers.custom.CustomTokenizer', 'seq_len': 400, 'model_max_length': '${.seq_len}', 'padding': 'longest'}, 'loss': {'_target_': 'src.loss.weighted_supcon.weightedSupConLoss', 'temperature': 0.5, 'correlation_dir': '${oc.env:CONTRASTIVE_ROOT}/data/final_data/intronExonSeq_multizAlignment_noDash/trainTestVal_data'}, 'model': {'name_or_path': 'simclr', 'hidden_dim': 512, 'projection_dim': 128}, 'optimizer': {'_target_': 'torch.optim.SGD', 'lr': 0.01, 'momentum': 0.9, 'weight_decay': 0.0}}"}
